---
title: "BuyerBehaviour"
author: "Imogen Meers"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
folder_path <- "data"

# List all .csv files in the folder
files <- list.files(folder_path, pattern = "*.csv", full.names = TRUE)

# Load all files into a list
data_list <- lapply(files, read.csv)
account_status = data_list[[1]]
demo = data_list[[2]]
promos = data_list[[4]]
ticket_sales = data_list[[5]]

unique(account_status$STATUS)
library(dplyr)
grouped = ticket_sales %>% group_by(ACCOUNT_KEY) %>% arrange( desc(ACCOUNT_KEY), desc(SEASON_YEAR))
sums <- grouped %>% group_by(ACCOUNT_KEY, SEASON_YEAR) %>% summarise(ACCOUNT_KEY, SEASON_YEAR, ACCOUNT_TYPE, sum(TICKET_SOLD), sum(FLEX_PLAN_TICKET_SOLD), sum(FULL_PLAN_TICKET_SOLD), sum(FORTY_PLAN_TICKET_SOLD), sum(GROUP_TICKET_SOLD), sum(MINI_PLAN_TICKET_SOLD), sum(SEASON_TICKET_SOLD), sum(SINGLE_TICKET_SOLD), sum(SIXPACK_PLAN_TICKET_SOLD)) %>% distinct()

#separate by account_type: individual, group, business/corp
indiv_tickets <- grouped %>% filter(ACCOUNT_TYPE == "Individual") %>% group_by(ACCOUNT_KEY, SEASON_YEAR) %>% summarise(ACCOUNT_KEY, SEASON_YEAR, ACCOUNT_TYPE, sum(TICKET_SOLD), sum(FLEX_PLAN_TICKET_SOLD), sum(FULL_PLAN_TICKET_SOLD), sum(FORTY_PLAN_TICKET_SOLD), sum(GROUP_TICKET_SOLD), sum(MINI_PLAN_TICKET_SOLD), sum(SEASON_TICKET_SOLD), sum(SINGLE_TICKET_SOLD), sum(SIXPACK_PLAN_TICKET_SOLD)) %>% distinct()

#indiv buy group, one person buys 15+, suite etc.

busi_tickets <- grouped %>% filter(ACCOUNT_TYPE == "Business") %>%group_by(ACCOUNT_KEY, SEASON_YEAR) %>% summarise(ACCOUNT_KEY, SEASON_YEAR, ACCOUNT_TYPE, sum(TICKET_SOLD), sum(FLEX_PLAN_TICKET_SOLD), sum(FULL_PLAN_TICKET_SOLD), sum(FORTY_PLAN_TICKET_SOLD), sum(GROUP_TICKET_SOLD), sum(MINI_PLAN_TICKET_SOLD), sum(SEASON_TICKET_SOLD), sum(SINGLE_TICKET_SOLD), sum(SIXPACK_PLAN_TICKET_SOLD)) %>% distinct()

group_tickets <- grouped %>% filter(ACCOUNT_TYPE == "Group") %>%group_by(ACCOUNT_KEY, SEASON_YEAR) %>% summarise(ACCOUNT_KEY, SEASON_YEAR, ACCOUNT_TYPE, sum(TICKET_SOLD), sum(FLEX_PLAN_TICKET_SOLD), sum(FULL_PLAN_TICKET_SOLD), sum(FORTY_PLAN_TICKET_SOLD), sum(GROUP_TICKET_SOLD), sum(MINI_PLAN_TICKET_SOLD), sum(SEASON_TICKET_SOLD), sum(SINGLE_TICKET_SOLD), sum(SIXPACK_PLAN_TICKET_SOLD)) %>% distinct()

#group buys group

```


